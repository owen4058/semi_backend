<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
  <mapper namespace="mapper.review">
  	<resultMap id="reviewResult" type="review">
  		<result property="reviewid" column="REVIEWID"/>
		<result property="movie_id" column="MOVIE_ID"/>
		<result property="userid" column="USERID"/>
		<result property="content" column="CONTENT"/>
		<result property="rating" column="RATING"/>
		<result property="user_liked" column="user_liked"/>
		<result property="likes" column="LIKES"/>
		<result property="creationdate" column="CREATIONDATE"/>
  	</resultMap>
	
	<select id="selectAllReviewList" resultMap="reviewResult" parameterType="int">
	<![CDATA[
		SELECT * FROM REVIEW
        WHERE movie_id = #{movie_id}
        ORDER BY  CREATIONDATE DESC
	]]>
	
	</select>
	<select id="selectReview" parameterType="review">
		<![CDATA[
		    SELECT * FROM review WHERE reviewId = #{reviewId}
		]]>
	</select>
  	
  	<insert id="insertReview" parameterType="review">
  		<![CDATA[
	        INSERT INTO REVIEW (movie_id, reviewid, useraccount, content, rating, CREATIONDATE)
	        VALUES (#{movie_id}, review_id_seq.NEXTVAL, #{useraccount}, #{content}, #{rating}, SYSDATE)
    	]]>
  	</insert>
  	
  	<update id="updateReview" parameterType="review">
	    <![CDATA[
	        UPDATE REVIEW
	        SET content = #{content}, creationdate = SYSDATE
	        WHERE reviewId = #{reviewId}
	    ]]>
	</update>
	
	<delete id="deleteReview" parameterType="review">
	    <![CDATA[
	        DELETE FROM REVIEW
	        WHERE reviewId = #{reviewId}
	    ]]>
	</delete>
	
  	
  
  </mapper>
  